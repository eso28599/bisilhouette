<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bisilhouette • bisilhouette</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bisilhouette">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bisilhouette</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/res.html">Bisilhouette</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eso28599/bisilhouette/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bisilhouette</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/eso28599/bisilhouette/blob/main/vignettes/res.Rmd" class="external-link"><code>vignettes/res.Rmd</code></a></small>
      <div class="d-none name"><code>res.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/eso28599/bisilhouette" class="external-link">bisilhouette</a></span><span class="op">)</span></span></code></pre></div>
<p>The bisilhouette score is an extension of the silhouette score to the
bicluster case. It is a measure of the quality of a biclustering, taking
into account the compactness and separation of the biclusters. This
vignette provides an overview of the bisilhouette score and how it can
be used to evaluate biclustering results.</p>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="calculate-score">Calculate score<a class="anchor" aria-label="anchor" href="#calculate-score"></a>
</h3>
<p>The function <code>bisilhouette</code> calculates the bisilhouette
score of a biclustering. See the package landing page for more details
on the input parameters.</p>
</div>
<div class="section level3">
<h3 id="visualisations">Visualisations<a class="anchor" aria-label="anchor" href="#visualisations"></a>
</h3>
<p>The function <code>plot_bisil</code> produces a visualisation of the
bisilhouette scores. The individual bisilhouette coefficients for each
of the rows is shown along the x axis, with rows grouped into the
assigned biclusters (denoted by different colours). The mean coefficient
is represented by the dashed line.</p>
<p>For example:</p>
<ol style="list-style-type: decimal">
<li>Bisilhouette plot for synthetic data with 3 views and 5 biclusters
using the true column clusters and 3 out of 5 of the correct row
clusters with the remaining row clusters having been reassigned
randomly.</li>
</ol>
<p align="center">
<img src="shuffled_bisil_plot.png" width="400"></p>
<ol start="2" style="list-style-type: decimal">
<li>Bisilhouette plot for biclusters obtained from a single cell
transcriptomic dataset.</li>
</ol>
<p align="center">
<img src="sc_bisil_plot.png" width="400"></p>
<p>Note that the axes ranges are different as the bisilhouette score is
not comporable across distinct datasets.</p>
</div>
</div>
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<div class="section level3">
<h3 id="silhouette-score">Silhouette score<a class="anchor" aria-label="anchor" href="#silhouette-score"></a>
</h3>
<p>The silhouette score that takes into account compactness and
separation of clusters as well as allowing for overlap and
non-membership. It considers the average distance between an element and
others belonging to the same cluster as well as the average distance to
the nearest cluster.</p>
<p>More specifically, for element
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in cluster
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
the average distance to the other elements in the same cluster is given
by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>R</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mo>∑</mo><mrow><mi>l</mi><mo>∈</mo><msub><mi>R</mi><mi>k</mi></msub></mrow></msub><msub><mi>d</mi><mrow><mi>i</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{i} =(|R_k|-1)^{-1} \sum_{l \in R_k}d_{il}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mrow><mi>j</mi><mi>l</mi></mrow></msub><annotation encoding="application/x-tex">d_{jl}</annotation></semantics></math>
be the Euclidean distance between row
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
and row
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>
of a matrix. The average distance to the elements in the next closest
cluster is calculated via
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>=</mo><munder><mtext mathvariant="normal">min</mtext><mrow><mi>j</mi><mo>∈</mo><mn>1</mn><mo>:</mo><mi>K</mi><mo>,</mo><mi>j</mi><mo>≠</mo><mi>k</mi></mrow></munder><msup><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>R</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mo>∑</mo><mrow><mi>l</mi><mo>∈</mo><msub><mi>R</mi><mi>j</mi></msub></mrow></msub><msub><mi>d</mi><mrow><mi>i</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">b_{i} = \underset{j \in 1:K, j\neq k }{\text{min}}|R_j|^{-1}\sum_{l \in R_j}d_{il}</annotation></semantics></math>.
The silhouette coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mi>i</mi></msub><annotation encoding="application/x-tex">s_{i}</annotation></semantics></math>
for element
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is defined by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>b</mi><mi>i</mi></msub><mo>−</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>b</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">s_{i} =(b_{i} - a_{i})/\operatorname{max}(b_{i},a_{i})</annotation></semantics></math>.
A score for each cluster is returned by averaging over the silhouette
coefficients corresponding to the elements in the cluster. These are
further averaged to give an overall score for the clustering as in
equation:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mfrac><mn>1</mn><mi>K</mi></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mfrac><mn>1</mn><msub><mi>n</mi><mi>k</mi></msub></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi>R</mi><mi>k</mi></msub></mrow></munder><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}\label{eq:sil}
    S = \frac{1}{K}\sum_{k=1}^{K}\frac{1}{n_k}\sum_{i\in R_k}s_{i}
\end{equation}</annotation></semantics></math></p>
<p>This is illustrated in the following image:</p>
<p align="center">
<img src="sil_image.png" width="400"></p>
</div>
<div class="section level3">
<h3 id="bicluster-extension">Bicluster extension<a class="anchor" aria-label="anchor" href="#bicluster-extension"></a>
</h3>
<p>To extend the silhouette score to the bicluster case, the silhouette
coefficients are calculated for each row in a given bicluster, based
only on the columns corresponding to that bicluster.</p>
<p>The data matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
is subsetted by the columns belonging to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>k</mi></msub><annotation encoding="application/x-tex">C_k</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>X</mi><mo accent="true">̃</mo></mover><mo>=</mo><msub><mi>X</mi><mrow><mi>.</mi><mo>,</mo><msub><mi>C</mi><mi>k</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">\tilde{X}=X_{.,C_k}</annotation></semantics></math>.
Treating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>j</mi></msub><annotation encoding="application/x-tex">{R_j}</annotation></semantics></math>
as the clusters, the silhouette coefficients for the elements of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>k</mi></msub><annotation encoding="application/x-tex">R_k</annotation></semantics></math>
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>X</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{X}</annotation></semantics></math>
are calculated. Averaging over the coefficients,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mi>k</mi></msub><annotation encoding="application/x-tex">B_k</annotation></semantics></math>
is found as illustrated in the figure below.</p>
<p align="center">
<img src="bisil_flow.png" width="600"></p>
<p>As with the silhouette score,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mi>k</mi></msub><annotation encoding="application/x-tex">B_k</annotation></semantics></math>
takes values in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[-1,1]</annotation></semantics></math>
with a higher score indicating a more compact and well separated
bicluster. A value of 1 is obtained if the columns are constant within
the bicluster. Care should be taken as this can be achieved when the
columns are constant across all rows, not just those belonging to the
bicluster. This issue is prevented by removing features with zero/very
low variance. An overall bisilhouette score
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
for the biclustering
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>R</mi><mi>k</mi></msub><mo>,</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mo stretchy="false" form="postfix">}</mo><mrow><mn>1</mn><mo>:</mo><mi>K</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\{(R_k,C_k)\}_{1:K}</annotation></semantics></math>
is given by calculating the mean over the non-zero
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mi>k</mi></msub><annotation encoding="application/x-tex">B_k</annotation></semantics></math>.
A score of zero is assumed to correspond to an empty bicluster - a
non-empty bicluster with score exactly zero is very unlikely for data
with any signal present.</p>
<p>The above assumes all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>k</mi></msub><annotation encoding="application/x-tex">R_k</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>k</mi></msub><annotation encoding="application/x-tex">C_k</annotation></semantics></math>
are non-empty and there are at least three unique sets amongst the row
clusters.</p>
<div class="section level4">
<h4 id="edge-cases">Edge cases<a class="anchor" aria-label="anchor" href="#edge-cases"></a>
</h4>
<p>There are several edge cases to consider when calculating the
bisilhouette score.</p>
<p>Suppose the row and column clusters present in a biclustering have
been successfully identified, but they are all incorrectly paired.
Consider case (i) where there are at least three unique row clusters. In
calculating the silhouette score for the first column cluster, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>i</mi></msub><annotation encoding="application/x-tex">a_i</annotation></semantics></math>
values for this bicluster are likely to be small as these rows do not
form part of a bicluster over the columns considered. At least one of
the row clusters is also not associated with this column clusters and
will likely constitute the next closest bicluster. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>i</mi></msub><annotation encoding="application/x-tex">b_i</annotation></semantics></math>
values for this bicluster are again likely to be small (similar to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>i</mi></msub><annotation encoding="application/x-tex">a_i</annotation></semantics></math>
values) and so a small overall score for this bicluster will be
returned. Consider case (ii) where there are at maximum two unique row
clusters. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>i</mi></msub><annotation encoding="application/x-tex">a_i</annotation></semantics></math>
values are calculated as before, but as there is only one other row
cluster the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>i</mi></msub><annotation encoding="application/x-tex">b_i</annotation></semantics></math>
values correspond to the true row cluster. However, these rows do
exhibit different behaviour over the considered columns. This leads to
larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>i</mi></msub><annotation encoding="application/x-tex">b_i</annotation></semantics></math>
values and an inflated overall score, despite the absence of any
correctly identified biclusters. Similarly, when the biclusters are
simply not informative a similar effect is seen; if there is by chance
more variation in the `other’ row cluster considered this could cause
larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>i</mi></msub><annotation encoding="application/x-tex">b_i</annotation></semantics></math>
values leading to an inflated score.</p>
<p>In order to mitigate this effect, when less than three unique row
clusters are present, extra row cluster are generated until this is no
longer the case. Each row is randomly assigned to the new row clusters
with a probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.1</mn><annotation encoding="application/x-tex">0.1</annotation></semantics></math>.
The bisilhouette score using this new set of row clusters is calculated.
It is worth noting that the generation of additional row clusters is
solely for the purpose of the calculation of the bisilhouette score.
This process is repeated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>10</mn><annotation encoding="application/x-tex">10</annotation></semantics></math>
times and the average score is reported.</p>
<p>If no biclusters are present a score of 0 is given. This ensures a
biclustering with a positive bisilhouette score (at least some
separation) will be chosen over an empty biclustering.</p>
<p>With these edge cases considered, the bisilhouette score can be
calculated for any number of biclusters, allowing for comparison between
any two sets of biclustering results. This is in contrast to the
silhouette score which is only defined for two or more clusters.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ella Orme.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
